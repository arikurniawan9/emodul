<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Unit 3 - Extracurricular Dialogue</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tambahkan ini di <head> -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <audio id="clickSound" src="../sounds/click.mp3" preload="auto"></audio>
    <style>
      /* Animasi background gradasi */
      body {
        font-family: "Segoe UI", sans-serif;
        margin: 0;
        padding: 20px;
        animation: gradientShift 12s ease infinite;
        background: url("../img/bg_menu.png") no-repeat center center fixed;
        background-size: 400% 400%;
        transition: background 2s ease;
      }

      @keyframes gradientShift {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .typing-title {
        font-family: monospace;
        overflow: hidden;
        white-space: nowrap;
        border-right: 3px solid #fff;
        width: 0;
        animation: typing 4s steps(30, end) forwards,
          blink 0.7s step-end infinite;
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      @keyframes blink {
        50% {
          border-color: transparent;
        }
      }

      h1,
      h3 {
        text-align: center;
        color: #333;
      }

      .chat-container {
        max-width: 700px;
        margin: 30px auto;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .chat-bubble {
        padding: 14px 18px;
        border-radius: 20px;
        position: relative;
        max-width: 80%;
        font-size: 1rem;
        transition: background-color 0.4s, transform 0.3s;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .left {
        align-self: flex-start;
        background-color: #e3f2fd;
        border-bottom-left-radius: 0;
      }

      .right {
        align-self: flex-end;
        background-color: #dcedc8;
        border-bottom-right-radius: 0;
      }

      .active {
        animation: highlight 0.5s ease-in-out forwards;
      }

      @keyframes highlight {
        0% {
          transform: scale(1);
          box-shadow: 0 0 0 transparent;
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }
        100% {
          transform: scale(1);
        }
      }

      .controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .controls button {
        padding: 10px 18px;
        border: none;
        border-radius: 8px;
        background-color: #4caf50;
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .controls button:hover {
        background-color: #388e3c;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      }

      /* Tombol Home di kiri atas */
      .nav-home {
        position: absolute;
        top: 15px;
        left: 15px;
        z-index: 1000;
      }

      .nav-home img {
        width: 40px;
        height: 40px;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .nav-home img:hover {
        transform: scale(1.1);
      }
      .animated-btn {
        display: inline-block;
        padding: 12px 24px;
        color: #fff;
        background: linear-gradient(45deg, #ff6b6b, #f8ad0c);
        border: none;
        border-radius: 50px;
        font-size: 1rem;
        font-weight: 600;
        position: relative;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .animated-btn::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(45deg) translate(-100%, -100%);
        transition: transform 0.7s ease;
      }

      .animated-btn:hover {
        transform: translateY(-3px) scale(1.02);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      }

      .animated-btn:hover::before {
        transform: rotate(45deg) translate(0, 0);
      }
      .glow-pulse {
        text-align: center;
        font-size: 2rem;
        color: #ffffff;
        animation: pulseGlow 2.5s infinite ease-in-out;
        text-shadow: 0 0 5px #ffffff, 0 0 10px #f0f, 0 0 15px #f0f,
          0 0 20px #0ff;
      }

      @keyframes pulseGlow {
        0%,
        100% {
          transform: scale(1);
          text-shadow: 0 0 5px #ffffff, 0 0 10px #f0f, 0 0 15px #f0f,
            0 0 20px #0ff;
        }
        50% {
          transform: scale(1.1);
          text-shadow: 0 0 10px #fff, 0 0 20px #f0f, 0 0 30px #f0f,
            0 0 40px #0ff;
        }
      }
    </style>
  </head>
  <body>
    <!-- Tombol Home -->
    <div class="nav-home">
      <a href="../menu.html">
        <img src="../img/icon/home.png" alt="Home" title="Kembali ke Beranda" />
      </a>
    </div>
    üéß
    <h1>Unit 3</h1>
    <h1 class="glow-pulse">Extracurricular Activities</h1>
    <h3>Listen carefully to the following dialogue!</h3>

    <div class="chat-container" id="dialogue">
      <div class="chat-bubble left" data-speaker="Rafi">
        Rafi: Hey, what extracurricular are you joining today?
      </div>
      <div class="chat-bubble right" data-speaker="Dinda">
        Dinda: I‚Äôm joining the English Club. It‚Äôs really fun!
      </div>
      <div class="chat-bubble left" data-speaker="Rafi">
        Rafi: Wow, cool! I‚Äôm still not sure which one to choose.
      </div>
      <div class="chat-bubble right" data-speaker="Dinda">
        Dinda: Do you like sports? Basketball or futsal is exciting.
      </div>
      <div class="chat-bubble left" data-speaker="Rafi">
        Rafi: Yeah, I‚Äôm interested in the futsal club.
      </div>
      <div class="chat-bubble right" data-speaker="Dinda">
        Dinda: You should try it next week. You might like it!
      </div>
    </div>

    <div class="controls">
      <button class="animated-btn" onclick="playDialogue()">‚ñ∂Ô∏è Play</button>
      <button class="animated-btn" onclick="stopDialogue()">‚èπÔ∏è Stop</button>
      <button class="animated-btn" onclick="resetDialogue()">üîÑ Reset</button>
    </div>

    <!-- Bottom Toolbar -->
    <nav
      class="fixed bottom-0 inset-x-0 bg-white/10 backdrop-blur-md border-t border-white/20 shadow-lg z-50"
    >
      <div
        class="max-w-xl mx-auto flex justify-around items-center py-3 px-4 text-sm text-white"
      >
        <!-- Back -->
        <a
          onclick="playClick()"
          href="../menu.html"
          class="flex flex-col items-center text-white hover:text-purple-300 transition-transform hover:scale-110"
        >
          <i class="fas fa-arrow-left text-lg mb-1"></i>
          <span class="text-xs">Back</span>
        </a>

        <!-- Home -->
        <a
          onclick="playClick()"
          href="../menu.html"
          class="flex flex-col items-center text-white hover:text-blue-300 transition-transform hover:scale-110"
        >
          <i class="fas fa-home text-lg mb-1"></i>
          <span class="text-xs">Home</span>
        </a>

        <!-- Dialog 2 -->
        <a
          onclick="playClick()"
          href="unit3_part2_dialog1.html"
          class="flex flex-col items-center text-white hover:text-green-300 transition-transform hover:scale-110"
        >
          <i class="fas fa-arrow-right text-lg mb-1"></i>
          <span class="text-xs">Activity 2</span>
        </a>
      </div>
    </nav>

    <script>
      const audioBasePath = "../audio/";
      const dialogueElements = document.querySelectorAll(".chat-bubble");
      const audioQueue = [];

      dialogueElements.forEach((el, index) => {
        const speaker = el.dataset.speaker;
        const audio = new Audio(
          `${audioBasePath}${speaker}${Math.floor(index / 2) + 1}.wav`
        );
        audioQueue.push({ el, audio });
      });

      let current = 0;
      let isPlaying = false;

      function playDialogue() {
        if (isPlaying || current >= audioQueue.length) return;
        isPlaying = true;
        playNext();
      }

      function playNext() {
        if (current >= audioQueue.length) {
          isPlaying = false;
          return;
        }

        const { el, audio } = audioQueue[current];

        dialogueElements.forEach((d) => d.classList.remove("active"));
        el.classList.add("active");

        audio.play();
        audio.onended = () => {
          current++;
          setTimeout(playNext, 400);
        };
      }

      function stopDialogue() {
        isPlaying = false;
        if (audioQueue[current]) audioQueue[current].audio.pause();
        dialogueElements.forEach((d) => d.classList.remove("active"));
      }

      function resetDialogue() {
        stopDialogue();
        current = 0;
        audioQueue.forEach(({ audio }) => {
          audio.currentTime = 0;
        });
      }
    </script>
  </body>
</html>
